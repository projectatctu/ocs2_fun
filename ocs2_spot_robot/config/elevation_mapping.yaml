input_sources:
  camera_front_left: # A name to identify the input source
    type: pointcloud # Supported types: pointcloud
    topic: /camera_front_left/depth/points_downsampled
    queue_size: 1
    publish_on_update: false # Whether to publish the elevation map after a callback from this source.
    sensor_processor:
      type: perfect

  camera_front_right: # A name to identify the input source
    type: pointcloud # Supported types: pointcloud
    topic: /camera_front_right/depth/points_downsampled
    queue_size: 1
    publish_on_update: false # Whether to publish the elevation map after a callback from this source.
    sensor_processor:
      type: perfect

  camera_left: # A name to identify the input source
    type: pointcloud # Supported types: pointcloud
    topic: /camera_left/depth/points_downsampled
    queue_size: 1
    publish_on_update: false # Whether to publish the elevation map after a callback from this source.
    sensor_processor:
      type: perfect

  camera_right: # A name to identify the input source
    type: pointcloud # Supported types: pointcloud
    topic: /camera_right/depth/points_downsampled
    queue_size: 1
    publish_on_update: false # Whether to publish the elevation map after a callback from this source.
    sensor_processor:
      type: perfect

  camera_back:
    type: pointcloud # Supported types: pointcloud
    topic: /camera_back/depth/points_downsampled
    queue_size: 1
    publish_on_update: true # Whether to publish the elevation map after a callback from this source.
    sensor_processor:
      type: perfect


map_frame_id: "world"
robot_base_frame_id: "base"
robot_pose_with_covariance_topic: "" # Leaving this empty skipps pose covariance updates.
robot_pose_cache_size: 40
track_point_frame_id: "base"
track_point_x: 0.0
track_point_y: 0.0
track_point_z: 0.0

# Map.
length_in_x:                                3.0
length_in_y:                                3.0
position_x:                                 0.0
position_y:                                 0.0
resolution:                                 0.06
min_variance:                               0.0001
max_variance:                               0.05
mahalanobis_distance_threshold:             2.5
multi_height_noise:                         0.001
surface_normal_positive_axis:               z
fused_map_publishing_rate:                  0.5
enable_visibility_cleanup:                  true
visibility_cleanup_rate:                    1.0
scanning_duration:                          1.0

# Init submap
initialize_elevation_map:                   true
initialization_method:                      0
length_in_x_init_submap:                    3.0
length_in_y_init_submap:                    3.0
init_submap_height_offset:                  -0.01
init_submap_variance:                       0.001
target_frame_init_submap:                   world

# Postprocessing pipeline
postprocessor_pipeline:

  - name: inpaint
    type: gridMapCv/InpaintFilter
    params:
      input_layer: elevation
      output_layer: elevation2
      radius: 0.4

  - name: minus_one
    type: gridMapFilters/MathExpressionFilter
    params:
      output_layer: elevation_minus_one
      expression: -elevation2

  - name: min_in_radius
    type: gridMapFilters/MinInRadiusFilter
    params:
      input_layer: elevation_minus_one
      output_layer: elevation_minus_one_min_in_radius
      radius: 0.3
    
  - name: minus_two
    type: gridMapFilters/MathExpressionFilter
    params:
      output_layer: elevation_minus_one_min_in_radius2
      expression: -elevation_minus_one_min_in_radius
  
  - name: smooth
    type: gridMapFilters/MeanInRadiusFilter
    params:
      input_layer: elevation_minus_one_min_in_radius2
      output_layer: smooth_planar
      radius: 0.2